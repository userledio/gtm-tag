___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Userled",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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\u003d\u003d"
  },
  "description": "Install the Userled SDK snippet.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "appId",
    "displayName": "App ID",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "REGEX",
        "args": [
          "^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$"
        ]
      }
    ],
    "alwaysInSummary": true,
    "notSetText": "Not set",
    "help": "Find your App ID here: https://app.userled.io/settings"
  },
  {
    "type": "SELECT",
    "name": "method",
    "displayName": "What should be triggered?",
    "macrosInSelect": false,
    "selectItems": [
      {
        "value": "installAndPage",
        "displayValue": "Install and track page load"
      },
      {
        "value": "install",
        "displayValue": "Install only"
      },
      {
        "value": "page",
        "displayValue": "Track page load only"
      }
    ],
    "simpleValueType": true,
    "help": "For information and guidance visit:\nhttps://userled-io.notion.site/Userled-Guides-41ee4bf2f78f40318fef20643a9f67fb",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "alwaysInSummary": true
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const log = require('logToConsole');
const copyFromWindow = require('copyFromWindow');
const setInWindow = require('setInWindow');
const injectScript = require('injectScript');
const callInWindow = require('callInWindow');

log('data =', data);

function initialiseQueue() {
  var userled = copyFromWindow("Userled");
  if (typeof userled === "function") return;
  
  userled = function() {
    callInWindow('Userled.call', arguments);
  };
  userled.call = function(args) {
    callInWindow('Userled.queue.push', args);
  };
  userled.queue = [];
  userled.snippetVersion = "1.0.0";

  setInWindow("Userled", userled);
}

function install() {
  if (!data.appId) {
    data.gtmOnFailure();
    return;
  }
  setInWindow("userledSettings", {
    app_id: data.appId,
  }, true);

  var scriptUrl = "https://api.userled.io/static/sdk.bundle.js";
  injectScript(
    scriptUrl,
    () => {
      log("Userled installed");
      data.gtmOnSuccess();
    },
    () => {
      log("Userled installation failed");
      data.gtmOnFailure();
    },
    scriptUrl
  );
}

function page() {
  callInWindow("Userled", "page");
  data.gtmOnSuccess();
}

function installAndPage() {
  install();
  callInWindow("Userled", "page");
  // install will call success/failure
}

const methodMap = {
  install: install,
  page: page,
  installAndPage: installAndPage,
};

function main() {
  initialiseQueue();
  const methodFunc = methodMap[data.method];
  if (!methodFunc) {
    log("Invalid method "+data.method);
    data.gtmOnFailure();
    return;
  }
  methodFunc();
}

main();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "userledSettings"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Userled"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Userled.call"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Userled.queue"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Userled.snippetVersion"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Userled.queue.push"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://api.userled.io/static/sdk.bundle.js"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Invalid method fails
  code: |-
    const mockData = {
      method: 'nonexistent',
    };

    // Call runCode to run the template's code.
    runCode(mockData);

    // Verify that the tag finished successfully.
    assertApi('gtmOnFailure').wasCalled();
- name: Install method succeeds
  code: |-
    const mockData = {
      method: 'install',
      appId: TEST_APP_ID,
    };

    mock('injectScript', function(url, onSuccess, onFailure, cacheToken) {
      assertThat(url).isEqualTo("https://api.userled.io/static/sdk.bundle.js");
      onSuccess();
    });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();
- name: Page adds page to queue
  code: |-
    const copyFromWindow = require('copyFromWindow');

    const mockData = {
      method: 'page',
      appId: TEST_APP_ID,
    };

    let userled = copyFromWindow('Userled');
    const q_length = userled.queue.length;

    // Call runCode to run the template's code.
    runCode(mockData);

    userled = copyFromWindow('Userled');
    assertThat(userled.queue.length).isEqualTo(q_length+1);
    assertThat(userled.queue[q_length]).isEqualTo(["page"]);

    // Verify that the tag finished successfully.
    assertApi('gtmOnSuccess').wasCalled();
- name: Install method fails
  code: |-
    const mockData = {
      method: 'install',
      appId: TEST_APP_ID,
    };

    mock('injectScript', function(url, onSuccess, onFailure, cacheToken) {
      onFailure();
    });

    runCode(mockData);

    assertApi('gtmOnFailure').wasCalled();
- name: Install and page succeeds
  code: |
    const copyFromWindow = require('copyFromWindow');

    const mockData = {
      method: 'installAndPage',
      appId: TEST_APP_ID,
    };

    mock('injectScript', function(url, onSuccess, onFailure, cacheToken) {
      onSuccess();
    });

    let userled = copyFromWindow('Userled');
    const q_length = userled.queue.length;

    runCode(mockData);

    userled = copyFromWindow('Userled');
    assertThat(userled.queue.length).isEqualTo(q_length + 1);
    assertThat(userled.queue[q_length]).isEqualTo(["page"]);

    assertApi('gtmOnSuccess').wasCalled();
- name: Install and page twice
  code: |
    const copyFromWindow = require('copyFromWindow');

    const installAndPage = {
      method: 'installAndPage',
      appId: TEST_APP_ID,
    };

    mock('injectScript', function(url, onSuccess, onFailure, cacheToken) {
      onSuccess();
    });

    let userled = copyFromWindow('Userled');
    const q_length = userled.queue.length;

    runCode(installAndPage);

    userled = copyFromWindow('Userled');
    assertThat(userled.queue.length).isEqualTo(q_length + 1);
    assertThat(userled.queue[q_length]).isEqualTo(["page"]);

    assertApi('gtmOnSuccess').wasCalled();

    const pageAgain = {
      method: 'page',
      appId: TEST_APP_ID,
    };

    runCode(pageAgain);

    userled = copyFromWindow('Userled');
    assertThat(userled.queue.length).isEqualTo(q_length + 2);
    assertThat(userled.queue[q_length + 1]).isEqualTo(["page"]);

    assertApi('gtmOnSuccess').wasCalled();
- name: Page with overridden call method
  code: |-
    const setInWindow = require('setInWindow');
    const callInWindow = require('callInWindow');
    const copyFromWindow = require('copyFromWindow');

    // 1. Install snippet
    const install = {
      method: 'install',
      appId: TEST_APP_ID,
    };
    mock('injectScript', function(url, onSuccess, onFailure, cacheToken) {
      onSuccess();
    });
    runCode(install);
    assertApi('gtmOnSuccess').wasCalled();

    // 2. Override call method
    const success = setInWindow('Userled.call', function(args) {
      callInWindow('Userled.queue.push', ["overridden"]);
    }, true);
    assertThat(success).isTrue();

    // 3. Call page
    const page = {
      method: 'page',
      appId: TEST_APP_ID,
    };

    let userled = copyFromWindow('Userled');
    const queueLen = userled.queue.length;

    runCode(page);

    userled = copyFromWindow('Userled');
    assertThat(userled.queue.length).isEqualTo(queueLen + 1);
    assertThat(userled.queue[queueLen]).isEqualTo(["overridden"]);

    assertApi('gtmOnSuccess').wasCalled();
setup: const TEST_APP_ID="360e1a78-2fb5-497b-81b6-5dc7f71b88f6";


___NOTES___

Created on 09/03/2023, 14:23:20


